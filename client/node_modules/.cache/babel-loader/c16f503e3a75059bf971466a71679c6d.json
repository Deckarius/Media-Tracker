{"ast":null,"code":"import _slicedToArray from\"/Users/miguel/Documents/Github/Media-Tracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useState,useEffect}from'react';import{Button,FormGroup,FormControl,Form}from'react-bootstrap';import{withRouter}from'react-router-dom';import Layout from'../components/Layout';import'../styles/Register.css';var Register=function Register(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),confirmPassword=_useState8[0],setConfirmPassword=_useState8[1];useEffect(function(){// if logged in redirect to profile\nfetch(\"/api/getUserDetails\",{credentials:'include'}).then(function(res){if(res.status===200){return res.json();}}).then(function(data){props.history.push(\"/profile/\"+data.username);}).catch(function(err){// user not logged in, or error\n});},[]);function validateForm(){return username.length>0&&email.length>0&&password.length>0&&password===confirmPassword;}function handleSubmit(event){event.preventDefault();fetch(\"/api/register?username=\"+username+\"&email=\"+email+\"&password=\"+password,{credentials:'include'}).then(function(res){if(res.status===200){alert(\"Registration successful. Welcome!\");fetch(\"/api/auth?email=\"+email+\"&password=\"+password,{credentials:'include'}).then(function(res){if(res.status===200){props.history.push('/profile/'+username);}else{var error=new Error(res.error);throw error;}}).catch(function(err){console.error(err);});}else{var error=new Error(res.error);throw error;}}).catch(function(err){console.error(err);alert('Error registering. Please try again.');});}return React.createElement(Layout,null,React.createElement(\"h1\",{style:{borderBottom:'1px solid black'}},\"Register\"),React.createElement(\"div\",{className:\"Register\"},React.createElement(\"form\",{onSubmit:handleSubmit},React.createElement(FormGroup,{controlId:\"username\",bsSize:\"large\"},React.createElement(Form.Label,null,\"Username\"),React.createElement(FormControl,{autoFocus:true,type:\"username\",value:username,onChange:function onChange(e){return setUsername(e.target.value);}})),React.createElement(FormGroup,{controlId:\"email\",bsSize:\"large\"},React.createElement(Form.Label,null,\"Email\"),React.createElement(FormControl,{type:\"email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})),React.createElement(FormGroup,{controlId:\"password\",bsSize:\"large\"},React.createElement(Form.Label,null,\"Password\"),React.createElement(FormControl,{value:password,onChange:function onChange(e){return setPassword(e.target.value);},type:\"password\"})),React.createElement(FormGroup,{controlId:\"confirmPassword\",bsSize:\"large\"},React.createElement(Form.Label,null,\"Confirm password\"),React.createElement(FormControl,{value:confirmPassword,onChange:function onChange(e){return setConfirmPassword(e.target.value);},type:\"password\"})),React.createElement(Button,{block:true,bsSize:\"large\",disabled:!validateForm(),type:\"submit\"},\"Register\"))));};export default withRouter(Register);","map":{"version":3,"sources":["/Users/miguel/Documents/Github/Media-Tracker/src/pages/Register.js"],"names":["React","useState","useEffect","Button","FormGroup","FormControl","Form","withRouter","Layout","Register","props","username","setUsername","email","setEmail","password","setPassword","confirmPassword","setConfirmPassword","fetch","credentials","then","res","status","json","data","history","push","catch","err","validateForm","length","handleSubmit","event","preventDefault","alert","error","Error","console","borderBottom","e","target","value"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useState, useEffect } from 'react';\nimport { Button, FormGroup, FormControl, Form } from 'react-bootstrap';\nimport { withRouter } from 'react-router-dom';\nimport Layout from '../components/Layout';\nimport '../styles/Register.css';\n\nconst Register = props => {\n    const [username, setUsername] = useState(\"\");\n    const [email, setEmail] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [confirmPassword, setConfirmPassword] = useState(\"\");\n\n    useEffect(() => {\n        // if logged in redirect to profile\n        fetch(\"/api/getUserDetails\", { credentials: 'include' })\n            .then(res => {\n                if (res.status === 200) {\n                    return res.json();\n                }\n            }).then(data => {\n                props.history.push(\"/profile/\" + data.username);\n            })\n            .catch(err => {\n                // user not logged in, or error\n            });\n    }, []);\n\n    function validateForm() {\n        return username.length > 0 && email.length > 0\n            && password.length > 0 && (password === confirmPassword);\n    }\n\n    function handleSubmit(event) {\n        event.preventDefault();\n        fetch(\"/api/register?username=\" + username + \"&email=\" + email + \"&password=\" + password\n            , { credentials: 'include' })\n            .then(res => {\n                if (res.status === 200) {\n                    alert(\"Registration successful. Welcome!\");\n                    fetch(\"/api/auth?email=\" + email + \"&password=\" + password\n                        , { credentials: 'include' })\n                        .then(res => {\n                            if (res.status === 200) {\n                                props.history.push('/profile/' + username);\n                            } else {\n                                const error = new Error(res.error);\n                                throw error;\n                            }\n                        })\n                        .catch(err => {\n                            console.error(err);\n                        });\n                } else {\n                    const error = new Error(res.error);\n                    throw error;\n                }\n            })\n            .catch(err => {\n                console.error(err);\n                alert('Error registering. Please try again.');\n            });\n    }\n\n    return (\n        <Layout>\n            <h1 style={{ borderBottom: '1px solid black' }}>Register</h1>\n            <div className=\"Register\">\n                <form onSubmit={handleSubmit}>\n                    <FormGroup controlId=\"username\" bsSize=\"large\">\n                        <Form.Label>Username</Form.Label>\n                        <FormControl\n                            autoFocus\n                            type=\"username\"\n                            value={username}\n                            onChange={e => setUsername(e.target.value)}\n                        />\n                    </FormGroup>\n                    <FormGroup controlId=\"email\" bsSize=\"large\">\n                        <Form.Label>Email</Form.Label>\n                        <FormControl\n                            type=\"email\"\n                            value={email}\n                            onChange={e => setEmail(e.target.value)}\n                        />\n                    </FormGroup>\n                    <FormGroup controlId=\"password\" bsSize=\"large\">\n                        <Form.Label>Password</Form.Label>\n                        <FormControl\n                            value={password}\n                            onChange={e => setPassword(e.target.value)}\n                            type=\"password\"\n                        />\n                    </FormGroup>\n                    <FormGroup controlId=\"confirmPassword\" bsSize=\"large\">\n                        <Form.Label>Confirm password</Form.Label>\n                        <FormControl\n                            value={confirmPassword}\n                            onChange={e => setConfirmPassword(e.target.value)}\n                            type=\"password\"\n                        />\n                    </FormGroup>\n                    <Button block bsSize=\"large\" disabled={!validateForm()} type=\"submit\">\n                        Register\n                    </Button>\n                </form>\n            </div>\n        </Layout>\n    );\n};\n\nexport default withRouter(Register);"]},"metadata":{},"sourceType":"module"}