{"ast":null,"code":"import _classCallCheck from\"/Users/miguel/Documents/Github/Media-Tracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/miguel/Documents/Github/Media-Tracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/miguel/Documents/Github/Media-Tracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/miguel/Documents/Github/Media-Tracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/miguel/Documents/Github/Media-Tracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";// withAuth.jsx\nimport React,{Component}from'react';import{Redirect}from'react-router-dom';export default function withAuth(ComponentToProtect){return(/*#__PURE__*/function(_Component){_inherits(_class,_Component);function _class(){var _this;_classCallCheck(this,_class);_this=_possibleConstructorReturn(this,_getPrototypeOf(_class).call(this));_this.state={loading:true,redirect:false};return _this;}_createClass(_class,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch('/api/checkToken',{credentials:'include'}).then(function(res){if(res.status===200){_this2.setState({loading:false});}else{var error=new Error(res.error);throw error;}}).catch(function(err){console.error(err);_this2.setState({loading:false,redirect:true});});}},{key:\"render\",value:function render(){var _this$state=this.state,loading=_this$state.loading,redirect=_this$state.redirect;if(loading){return null;}if(redirect){return React.createElement(Redirect,{to:\"/login\"});}return React.createElement(React.Fragment,null,React.createElement(ComponentToProtect,this.props));}}]);return _class;}(Component));}","map":{"version":3,"sources":["/Users/miguel/Documents/Github/Media-Tracker/src/components/withAuth.js"],"names":["React","Component","Redirect","withAuth","ComponentToProtect","state","loading","redirect","fetch","credentials","then","res","status","setState","error","Error","catch","err","console","props"],"mappings":"6zBAAA;AACA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,QAAT,KAAyB,kBAAzB,CAEA,cAAe,SAASC,CAAAA,QAAT,CAAkBC,kBAAlB,CAAsC,CACjD,sEACI,iBAAc,wCACV,0EACA,MAAKC,KAAL,CAAa,CACTC,OAAO,CAAE,IADA,CAETC,QAAQ,CAAE,KAFD,CAAb,CAFU,aAMb,CAPL,gFAQwB,iBAChBC,KAAK,CAAC,iBAAD,CAAoB,CAAEC,WAAW,CAAE,SAAf,CAApB,CAAL,CACKC,IADL,CACU,SAAAC,GAAG,CAAI,CACT,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAnB,CAAwB,CACpB,MAAI,CAACC,QAAL,CAAc,CAAEP,OAAO,CAAE,KAAX,CAAd,EACH,CAFD,IAEO,CACH,GAAMQ,CAAAA,KAAK,CAAG,GAAIC,CAAAA,KAAJ,CAAUJ,GAAG,CAACG,KAAd,CAAd,CACA,KAAMA,CAAAA,KAAN,CACH,CACJ,CARL,EASKE,KATL,CASW,SAAAC,GAAG,CAAI,CACVC,OAAO,CAACJ,KAAR,CAAcG,GAAd,EACA,MAAI,CAACJ,QAAL,CAAc,CAAEP,OAAO,CAAE,KAAX,CAAkBC,QAAQ,CAAE,IAA5B,CAAd,EACH,CAZL,EAaH,CAtBL,uCAuBa,iBACyB,KAAKF,KAD9B,CACGC,OADH,aACGA,OADH,CACYC,QADZ,aACYA,QADZ,CAEL,GAAID,OAAJ,CAAa,CACT,MAAO,KAAP,CACH,CACD,GAAIC,QAAJ,CAAc,CACV,MAAO,qBAAC,QAAD,EAAU,EAAE,CAAC,QAAb,EAAP,CACH,CACD,MACI,qBAAC,KAAD,CAAO,QAAP,MACI,oBAAC,kBAAD,CAAwB,KAAKY,KAA7B,CADJ,CADJ,CAKH,CApCL,oBAAqBlB,SAArB,GAsCH","sourcesContent":["// withAuth.jsx\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router-dom';\n\nexport default function withAuth(ComponentToProtect) {\n    return class extends Component {\n        constructor() {\n            super();\n            this.state = {\n                loading: true,\n                redirect: false,\n            };\n        }\n        componentDidMount() {\n            fetch('/api/checkToken', { credentials: 'include' })\n                .then(res => {\n                    if (res.status === 200) {\n                        this.setState({ loading: false });\n                    } else {\n                        const error = new Error(res.error);\n                        throw error;\n                    }\n                })\n                .catch(err => {\n                    console.error(err);\n                    this.setState({ loading: false, redirect: true });\n                });\n        }\n        render() {\n            const { loading, redirect } = this.state;\n            if (loading) {\n                return null;\n            }\n            if (redirect) {\n                return <Redirect to=\"/login\" />;\n            }\n            return (\n                <React.Fragment>\n                    <ComponentToProtect {...this.props} />\n                </React.Fragment>\n            );\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}